# 🚀 쿠팡윙 CS 자동화 Pro - 완벽 가이드

## 최신 트렌드 UI + 완전 자동화 시스템

---

## ✨ 새로운 기능

### 🎨 프리미엄 디자인
- **유리 효과 (Glassmorphism)**: 투명하고 세련된 카드 디자인
- **그라데이션 컬러**: 시각적으로 매력적인 색상 조합
- **실시간 애니메이션**: 프로그레스 바와 상태 표시기
- **반응형 레이아웃**: 크기 조절 가능한 창
- **다크 모드**: 눈의 피로를 줄이는 어두운 테마

### 🤖 완전 자동화
- **자동 서버 시작**: 포트 자동 탐지 및 서버 시작
- **원클릭 실행**: 한 번의 클릭으로 모든 과정 자동 진행
- **스마트 에러 처리**: 오류 발생 시 자동 복구 시도
- **실시간 모니터링**: 진행 상황 실시간 확인

---

## 🚀 빠른 시작 (3단계)

### 1단계: GUI 실행
```bash
# 배치 파일 더블클릭!
쿠팡윙_자동화_실행.bat
```

### 2단계: 로그인 정보 입력
- **이메일**: 쿠팡윙 로그인 이메일 주소
- **비밀번호**: 쿠팡윙 비밀번호
- **OpenAI API Key**: ChatGPT API 키 (sk-로 시작)

💡 **한 번만 입력하면 자동 저장됩니다!**

### 3단계: 자동화 시작
- 대형 **"▶️ 자동화 시작"** 버튼 클릭
- 나머지는 모두 자동으로 처리됩니다!
  - ✅ 환경 변수 자동 저장
  - ✅ 서버 자동 시작
  - ✅ 포트 자동 탐지
  - ✅ 로그인 및 자동화 실행
  - ✅ 통계 실시간 업데이트

---

## 📱 화면 구성

### 상단 헤더
```
🚀 쿠팡윙 CS 자동화              ● 시스템 대기 중
AI 기반 완전 자동화 시스템
```

- **좌측**: 앱 타이틀과 설명
- **우측**: 실시간 시스템 상태
  - ● 회색: 대기 중
  - ● 주황: 실행 중
  - ● 파랑: 처리 중
  - ● 초록: 완료
  - ● 빨강: 오류

### 왼쪽 패널 - 설정 및 컨트롤

#### 🔐 로그인 정보
```
이메일          [your_email@example.com    ]
비밀번호        [••••••••••••••••••••     ]
OpenAI API Key  [••••••••••••••••••••     ]
```

#### 🎯 실행 옵션
```
☑ Headless 모드 (백그라운드 실행)
```
- **체크**: 브라우저가 보이지 않음 (빠름, 권장)
- **해제**: 브라우저 창 보면서 실행 (디버깅용)

#### 실행 버튼
```
┌─────────────────────────────────────────────┐
│        ▶️  자동화 시작                        │
│     (큰 파란색 버튼 - 메인 실행)               │
└─────────────────────────────────────────────┘

[프로그레스 바]

┌──────────────────────┬──────────────────────┐
│  🔍 로그인 테스트    │    ⏹️ 중지           │
└──────────────────────┴──────────────────────┘
```

### 오른쪽 패널 - 실시간 모니터링

#### 📊 통계 대시보드
```
┌────────┬────────┬────────┬────────┐
│ 총 문의│답변완료│  실패  │ 건너뜀 │
│   0    │   0    │   0    │   0    │
└────────┴────────┴────────┴────────┘
```
- **파란색**: 총 문의 수
- **초록색**: 성공적으로 답변한 수
- **빨간색**: 실패한 수
- **주황색**: 건너뛴 수

#### 📝 실행 로그
```
[19:30:45] ✨ 시스템 준비 완료
[19:30:46] 💡 설정을 입력하고 '자동화 시작' 버튼을 클릭하세요
[19:31:20] 🚀 쿠팡윙 CS 자동화 시작
[19:31:21] 💾 환경 변수 저장 중...
[19:31:22] ✅ 환경 변수 저장 완료
...
```

---

## 🎯 사용 시나리오

### 시나리오 1: 처음 사용 (완전 자동)

1. **쿠팡윙_자동화_실행.bat** 더블클릭
2. 로그인 정보 입력
3. **Headless 모드 체크 해제** (브라우저 보면서 확인)
4. **▶️ 자동화 시작** 버튼 클릭
5. 시스템이 자동으로:
   - 환경 변수 저장
   - 빈 포트 찾기 (8000-8100)
   - 백엔드 서버 시작
   - 서버 연결 확인
   - 쿠팡윙 로그인
   - 모든 시간대 탭 확인
   - 문의 자동 답변
   - 통계 실시간 업데이트
6. 완료!

**소요 시간**: 약 2-5분 (문의 개수에 따라)

### 시나리오 2: 빠른 실행 (설정 저장 후)

1. **쿠팡윙_자동화_실행.bat** 더블클릭
2. 로그인 정보가 자동으로 채워져 있음
3. **Headless 모드 체크** (빠른 실행)
4. **▶️ 자동화 시작** 버튼 클릭
5. 백그라운드에서 모든 것이 자동 처리
6. 로그와 통계로 진행 상황 확인

**소요 시간**: 약 1-3분

### 시나리오 3: 로그인만 테스트

1. GUI 실행
2. 로그인 정보 입력
3. **Headless 모드 체크 해제**
4. **🔍 로그인 테스트** 버튼 클릭
5. 브라우저가 열리고 로그인 시도
6. 로그에서 결과 확인:
   - ✅ 로그인 성공!
   - ❌ 로그인 실패 (아이디/비밀번호 확인)

---

## 🎨 UI 디자인 특징

### 1. 유리 효과 (Glassmorphism)
- 반투명 배경
- 블러 효과
- 세련된 테두리

### 2. 컬러 시스템
```
파란색 (#3b82f6)   → 메인 액션, 통계
초록색 (#10b981)   → 성공, 완료
빨간색 (#ef4444)   → 오류, 실패
주황색 (#f59e0b)   → 경고, 건너뜀
보라색 (#8b5cf6)   → 테스트, 보조 기능
회색 (#6b7280)     → 정보, 비활성
```

### 3. 타이포그래피
- **헤더**: 36px, 굵게
- **섹션 타이틀**: 24px, 굵게
- **카드 타이틀**: 16px, 굵게
- **본문**: 13-14px
- **통계**: 32px, 굵게
- **로그**: Consolas 11px (모노스페이스)

### 4. 애니메이션
- **프로그레스 바**: 무한 로딩 애니메이션
- **버튼 호버**: 부드러운 색상 전환
- **상태 표시기**: 색상 변화

---

## 🔧 고급 기능

### 자동 포트 탐지
```python
서버 시작 시:
1. 8000번 포트 체크
2. 사용 중이면 8001 체크
3. 8100까지 순차 확인
4. 빈 포트 발견 시 자동 사용
```

### 스마트 서버 관리
```python
서버 상태:
- 자동 시작
- 연결 확인 (30회 재시도)
- 자동 재시작 (필요 시)
- 종료 시 자동 정리
```

### 에러 처리
```python
모든 단계에서:
- Try-Catch로 에러 포착
- 상세한 로그 출력
- 사용자 친화적 메시지
- 자동 복구 시도
```

---

## 💡 팁과 트릭

### 1. 처음 사용할 때
- **Headless 모드 OFF**: 브라우저를 보면서 무엇이 일어나는지 확인
- 로그를 자세히 읽기
- 문제가 없으면 다음부터 Headless ON

### 2. 정기적으로 사용할 때
- **Headless 모드 ON**: 빠르고 효율적
- GUI를 백그라운드에 두고 다른 작업 가능
- 통계 카드로 빠르게 확인

### 3. 문제 발생 시
- 로그 창에서 마지막 오류 메시지 확인
- **🔍 로그인 테스트**로 로그인 정보 검증
- Headless OFF로 브라우저 동작 직접 확인

### 4. 성능 최적화
- 문의가 많을 때는 Headless ON (더 빠름)
- 네트워크 안정적인 환경에서 실행
- 다른 프로그램 최소화

---

## 🔐 보안

### 환경 변수 보호
- `.env` 파일은 Git에 커밋되지 않음
- 로컬 컴퓨터에만 저장
- 비밀번호와 API 키는 ••• 로 표시

### API 키 관리
- OpenAI API 키는 안전하게 보관
- 주기적으로 변경 권장
- 사용량 모니터링: https://platform.openai.com/usage

---

## 📊 통계 해석

### 총 문의
- 모든 시간대 탭에서 발견된 문의 총 개수
- "72시간~30일" + "24~72시간" + "24시간 이내"

### 답변 완료
- 성공적으로 ChatGPT 답변 생성 및 저장
- 쿠팡윙 시스템에 답변 등록 완료

### 실패
- 답변 생성 또는 저장 중 오류 발생
- 재시도 필요

### 건너뜀
- 이미 답변된 문의
- 또는 특정 조건으로 건너뛴 문의

---

## 🐛 문제 해결

### GUI가 열리지 않음
```bash
# CustomTkinter 재설치
python -m pip install --upgrade customtkinter pillow

# GUI 직접 실행
python coupang_wing_gui.py
```

### 서버 시작 실패
```
로그 메시지 확인:
- "사용 가능한 포트를 찾을 수 없습니다"
  → 8000-8100 포트가 모두 사용 중
  → 다른 프로그램 종료 후 재시도

- "가상환경을 찾을 수 없습니다"
  → venv 폴더 확인
  → python -m venv venv 로 재생성
```

### 로그인 실패
```
확인 사항:
1. 아이디/비밀번호 정확한지 확인
2. Headless OFF로 브라우저 확인
3. 쿠팡윙 웹사이트 접속 가능한지 확인
4. 방화벽이나 VPN 설정 확인
```

### 자동화 오류
```
단계별 확인:
1. 로그에서 오류 메시지 찾기
2. 🔍 로그인 테스트 먼저 실행
3. Headless OFF로 어느 단계에서 멈추는지 확인
4. 네트워크 연결 확인
```

---

## 🎯 주요 개선 사항

### 이전 버전 대비
```
✅ UI 완전히 재설계 (프리미엄 디자인)
✅ 서버 자동 시작 (수동 시작 불필요)
✅ 포트 자동 탐지 (포트 충돌 해결)
✅ 원클릭 실행 (복잡한 단계 제거)
✅ 실시간 모니터링 (통계 + 로그)
✅ 스마트 에러 처리 (자동 복구)
✅ 프로그레스 표시 (진행 상황 시각화)
```

---

## 🚀 실행 흐름

```
1. 배치 파일 실행
   ↓
2. GUI 로딩
   ├─ 환경 변수 자동 로드
   └─ UI 초기화
   ↓
3. 사용자 입력 (처음만)
   ├─ 이메일
   ├─ 비밀번호
   └─ API 키
   ↓
4. "자동화 시작" 버튼 클릭
   ↓
5. 시스템 자동 처리
   ├─ 환경 변수 저장
   ├─ 빈 포트 탐지 (8000-8100)
   ├─ 백엔드 서버 시작
   ├─ 서버 연결 확인 (최대 30회)
   ├─ V2 자동화 API 호출
   ├─ 쿠팡윙 로그인
   ├─ 모든 탭 순회
   ├─ 문의 수집 및 처리
   ├─ ChatGPT 답변 생성
   ├─ 답변 저장
   └─ 통계 업데이트
   ↓
6. 완료!
```

---

## 📚 관련 파일

```
coupang_wing_gui.py          → 메인 GUI 프로그램
쿠팡윙_자동화_실행.bat       → 실행 배치 파일
backend/.env                 → 환경 변수 (자동 생성)
backend/app/main.py          → FastAPI 서버
backend/app/services/
  wing_web_automation_v2.py  → V2 자동화 로직
```

---

## 🎉 완료!

이제 쿠팡윙 CS 자동화를 프리미엄 GUI로 쉽게 사용하실 수 있습니다!

### 다음 단계:
1. **쿠팡윙_자동화_실행.bat** 더블클릭
2. 로그인 정보 입력
3. **▶️ 자동화 시작** 클릭
4. 커피 한 잔 하며 통계 확인 ☕

---

## 🆘 지원

문제가 발생하면:
1. 로그 창의 오류 메시지 확인
2. 이 가이드의 "문제 해결" 섹션 참조
3. Headless OFF로 디버깅

**즐거운 자동화 되세요! 🎉**
